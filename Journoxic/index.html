<!DOCTYPE html>

<html class="no-js" lang="en">
<head>
	<meta charset="utf-8" />
	<title>Anoxic's Journal Viewer</title>
	<link rel="stylesheet" href="css/app.css" type="text/css" />
	<link rel="stylesheet" href="css/jquery-ui.css" />
</head>
<body>
	<!-- Search bar -->
	<div class="header">
		<p id="sign-in-prompt">This is a website designed for keeping a journal, and is strongly customized to satisify the author's own need. For more information, visit the author's homepage for (possibly) more details. </p>
		<div id="search-new">
			<input type="text" id="query" class="search-text" autocomplete="off" onclick="this.select()" />
		</div>
		<div id="search-result">
			<p>Total entries: </p>
			<p id="total-entry">...</p>
			<p>Displayed: </p>
			<p id="total-displayed">...</p>
			<p>Total chars: </p>
			<p id="total-char">...</p>
			<p>Total lines: </p>
			<p id="total-line">...</p>
			<p>Total time:</p>
			<p id="total-time">...</p>
		</div>
	</div>
	<div id="feedback"></div>
	<div class="actions">
		<div id="action-option">
			<a title="Get current location" id="pin-point" onclick="edit.locationPin()" href="#">&#xf124</a>
			<a title="Play" id="play-media" onclick="app.audioPlayer.play()" href="#">&#xf04b</a>
			<a title="Stop" id="stop-media" onclick="app.audioPlayer.quit()" href="#">&#xf04d</a>
			<a title="Toggle fullscreen" id="toggle-media" onclick="app.videoPlayer.toggle()" href="#">&#xf065</a>
			<a id="confirm" onclick="edit.confirm()" href="#">&#xf00c</a>
		</div>
		<div id="action-fullscreen">
			<ul>
				<li><a  title="Toggle Light" id="toggle-light" onclick="edit.toggleLight()" href="#">&#xf0eb</a></li>
				<li><a title="Back to window" onclick="edit.windowMode()">&#xf066</a></li>
			</ul>
		</div>
		<div id="action-add">
			<ul>
				<li class="has-sub">
					<a title="Add Photos" onclick="edit.addMedia(0)" id="add-photo" href="#">&#xf03e</a>
					<ul>
						<li><a title="Add Video" onclick="edit.addMedia(1)" id="add-video" href="#">&#xf03d</a></li>
						<li><a title="Add Voice" onclick="edit.addMedia(3)" id="add-voice" href="#">&#xf130</a></li>
						<li><a title="Add Place" onclick="edit.addMedia(2)" id="add-place" href="#">&#xf041</a></li>
						<li><a title="Add Music" onclick="edit.addMedia(4)" id="add-music" href="#">&#xf001</a></li>
						<li><a title="Add Movie" onclick="edit.addMedia(5)" id="add-movie" href="#">&#xf008</a></li>
						<li><a title="Add Book" onclick="edit.addMedia(6)" id="add-book" href="#">&#xf02d</a></li>
						<li><a title="Add Link" onclick="edit.addMedia(7)" id="add-link" href="#">&#xf0c1</a></li>
					</ul>
				</li>
				<li class="has-sub">
					<a title="Save" id="add-save-local" onclick="edit.save('#add-save-local')" href="#">&#xf0c7</a>
					<ul>
						<li><a title="Discard and quit" id="add-discard" onclick="animation.setConfirm('discard')" href="#">&#xf014</a></li>
					</ul>
				</li>
				<li><a title="Add media from queue" onclick="edit.addMediaFromQueue()" id="add-queue">&#xf115</a></li>
				<li><a title="Go fullscreen" onclick="edit.fullScreen()" href="#">&#xf065</a></li>
			</ul>
		</div>
		<div id="action-archive">
			<ul>
				<li><a title="Read the archive" id="reread" onclick="edit.init(false)" href="#">&#xf187</a></li>
				<li><a title="Restore" id="archive-restore" onclick="archive.restore()" href="#">&#xf019</a></li>
				<li class="has-sub">
					<a title="Apply the changes" id="archive-apply" onclick="archive.apply()" href="#">&#xf058</a>
					<ul>
						<li><a title="Reverse selection" id="archive-reverse" onclick="archive.reverse()" href="#">&#xf056</a></li>
						<li><a title="Select archives below" id="archive-below" onclick="archive.selectBelow()" href="#">&#xf13a</a></li>
						<li><a title="Remove all the attributes" id="archive-clear" onclick="archive.clear()" href="#">&#xf057</a></li>
					</ul>
				</li>
				<li class="has-sub">
					<a title="Delete this archive" id="archive-delete" onclick="archive.toggle('delete')" href="#">&#xf1f8</a>
					<ul>
						<li><a title="Toggle protection on this archive file" id="archive-protect" onclick="archive.toggle('protect')" href="#">&#xf023</a></li>
					</ul>
				</li>
				<li><a title="Refresh" id="archive-refresh" onclick="archive.init('#archive-refresh')">&#xf021</a></li>
				<li><a title="Main menu" id="show-menu" onclick="animation.showMenuOnly()" href="#">&#xf0c9</a></li>
			</ul>
		</div>
		<div id="action-menu">
			<ul>
				<li class="has-sub">
					<a title="Edit this entry" id="edit-this" onclick="edit.init(undefined, app.currentDisplayed)" href="#"><span>&#xf044</span></a>
					<ul>
						<li><a title="Add an entry" id="add" onclick="edit.init()" href="#"><span>&#xf067</span></a></li>
						<li><a title="Delete this entry" id="delete" href="#"><span>&#xf00d</span></a></li>
					</ul>
				</li>
				<li class="has-sub">
					<a title="Refresh" id="refresh-media" onclick="app.refresh()" href="#"><span>&#xf021</span></a>
					<ul>
						<li><a title="Revert to archived data" id="undo-data" onclick="archive.init('#undo-data')" href="#">&#xf1da</a></li>
						<li><a title="Download latest data" id="download" onclick="downloadFile()" href="#">&#xf0ed</a></li>
						<li><a title="Update data" id="upload" onclick="uploadFile()" href="#">&#xf0ee</a></li>
						<li><a title="Refresh token" id="refresh-token" onclick="refreshToken()" href="#">&#xf084</a></li>
						<li><a title="Toggle auto-refresh token" id="toggle-refresh-token" onclick="toggleAutoRefreshToken()" href="#">&#xf204</a></li>
					</ul>
				</li>
				<li class="has-sub">
					<a title="Options" id="options">&#xf013</a>
					<ul>
						<li><a class="hidden" title="Return lost media" id="return-lost-media" onclick="app.cleanResource()" href="#">&#xf0f2</a></li>
						<li><a title="Find lost media" id="find-lost-media" onclick="app.checkResource()" href="#">&#xf002</a></li>
					</ul>
				</li>
			</ul>
		</div>
		<a title="Sign in via OneDrive" id="signin" onclick="odauth(true)" href="#">&#xf090</a>
	</div>
	<div id="video-fullscreen"></div>
	<!-- Main frame of the viewer -->
	<div id="app">
		<div id="contents">
			<div id="list"></div>
			<div id="detail"></div>
		</div>
		<div id="edit-pane"></div>
	</div>
	<div id="version"></div>
	<script id="odauth" src="js/odauth.v2.js" clientid="000000004C14D0D9" clientsecret="ywGrXJMufpTJxa5AsQCd3ovdMasZSnxf" scopes="wl.signin wl.offline_access onedrive.readwrite onedrive.appfolder" redirecturi="https://anoxdd.github.io/Journoxic/callback.html"></script>
	<script src="https://maps.googleapis.com/maps/api/js?v=3.exp&libraries=places"></script>
	<script src="js/lib/jquery.min.js"></script>
	<script src="js/lib/modernizr.min.js"></script>
	<script src="js/lib/jquery.grab.min.js"></script>
	<script src="js/lib/jquery.mousewheel.min.js"></script>
	<script src="js/lib/jquery.ui.min.js"></script>
	<script src="js/lib/jquery.hotkeys.js"></script>
	<script src="js/lib/underscore.min.js"></script>
	<script src="js/lib/swipe.min.js"></script>
	<script src="js/animation.js"></script>
	<script src="js/edit.js"></script>
	<script src="js/app.js"></script>
	<script src="js/archive.js"></script>
	<script src="js/onedrive.v2.js"></script>
	<script src="js/version.js"></script>
	<script type="text/x-template" id="list-view">
		<li>
			<%
			if (year != -1) {
			%>
			<p class="separator">
				<span>
					<%= year %>
				</span>
			</p>
			<%
			}
			%>
			<%
			if (month != -1) {
			%>
			<p class="separator">
				<span>
					<%= month %>
				</span>
			</p>
			<%
			}
			%>
			<a href="#">
				<div class="cover">
					<div class="ext"><%= ext %></div>
				</div>
				<p class="title"><%= title %></p>
				<p class="datetime"><%= datetime %></p>
				<p class="summary"><%= summary %></p>
				<div class="attached"><%= attached %></div>
			</a>
		</li>
	</script>
	<script type="text/x-template" id="detail-view">
		<div class="head">
			<p class="title"><%- title %></p>
			<p class="charline"><%- chars %></p>
			<p class="charline"><%- lines %></p>
			<p class="datetime"><%- datetime %></p>
		</div>
		<div class="content">
			<div class="upper photo"></div>
			<div class="center"></div>
			<div class="lower">
				<div class="text"><%= contents %></div>

				<%
				if( video ) {
				%>
				<div id="video-preview"></div>
				<%
				for( i in video ) {
				%>
				<div class="video">
					<a class="<%- video[i].fileName %>" href="#">
						<div class="thumb "><% if (video[i].thumb) { print(video[i].thumb); } %><span></span></div>
						<p class="title"><%- video[i].title %></p>
					</a>
				</div>
				<%
				}
				}

				if( voice ) {
				for( i in voice ) {
				%>
				<div class="voice">
					<a class="<%- voice[i].fileName %>" title="Listen to it">
						<div class="thumb"><span></span></div>
						<p class="title"><%- voice[i].title %></p>
					</a>
				</div>
				<%
				}
				}

				if( place ) {
				for( i in place ) {
				if (place[i].latitude) {
				%>
				<div class="place">
					<%
					%>
					<a href="https://maps.google.com/maps?z=15&q=<%- place[i].latitude %>,<%- place[i].longitude %>" target="_blank" title="See it in Google Map">
						<div class="thumb"></div>
						<p><%- place[i].title %></p>
					</a>
				</div>
				<%
				} else {
				%>
				<div class="place">
					<a href="https://maps.google.com/maps?z=15&q=<%- place[i].title %>" target="_blank" title="See it in Google Map">
						<div class="thumb"></div>
						<p><%- place[i].title %></p>
					</a>
				</div>
				<%
				}
				}
				}

				if( book ) {
				for( i in book ) {
				%>
				<div class="book">
					<img class="thumb <% if( book[i].thumb ) { book[i].thumb; } %>"><span></span>
					<p class="title"><%- book[i].title %></p>
					<p class="desc"><%- book[i].author %></p>
				</div>
				<%
				}
				}

				if( music ) {
				for( i in music ) {
				%>
				<div class="music">
					<img class="thumb <% if( music[i].thumb ) { music[i].thumb; } %>"><span></span>
					<p class="title"><%- music[i].title %></p>
					<p class="desc"><%- music[i].author %></p>
				</div>
				<%
				}
				}

				if( movie ) {
				for( i in movie ) {
				%>
				<div class="movie">
					<img class="thumb <% if( movie[i].thumb ) { movie[i].thumb; } %>"><span></span>
					<p class="title"><%- movie[i].title %></p>
					<p class="desc"><%- movie[i].author %></p>
				</div>
				<%
				}
				}

				if( weblink ) {
				for( i in weblink ) {
				%>
				<div class="weblink">
					<a href="<%- weblink[i].url %>" target="_blank" title="New Window">
						<div class="thumb"><% if( weblink[i].thumb ) { print( weblink[i].thumb ); } %><span></span></div>
						<p class="url"><%- weblink[i].url %></p>
						<p class="desc"><%- weblink[i].title %></p>
					</a>
				</div>
				<%
				}
				}

				if( iconTags ) {
				%>
				<div class="icontags">
					<%
					for( i in iconTags ) {
					print('<span class="' + iconTags[i] + '"></span>');
					}
					%>
				</div>
				<%
				}

				if( textTags ) {
				%>
				<div class="texttags">
					<p>
						<span>&#xf02c</span>
						<%
						for( i in textTags ) {
						if( i != 0 )
						print(', ');

						print( textTags[i] );
						}
						%>
					</p>
				</div>
				<%
				}
				%>
			</div>
		</div>
		<button type="button" class="btn-back"><span></span>Back</button>
	</script>
	<script type="text/x-template" id="edit-view">
		<div id="text-area">
			<input type="text" id="entry-header" autocomplete="off" onclick="this.select()" placeholder="Title" autofocus />
			<div id="entry-summary">
				<p class="entry-icons" id="chars" title="Chars">&#xf1dd</p>
				<p class="entry-data" id="entry-char" title="Chars">0</p>
				<p class="entry-icons" id="lines" title="Lines">&#xf03a</p>
				<p class="entry-data" id="entry-line" title="Lines">0</p>
				<p class="entry-icons" id="time" title="Current time">&#xf017</p>
				<p class="entry-data" id="entry-time" title="Current time">000000 0000</p>
				<p class="entry-icons" id="elapsed" title="Time elapsed">&#xf04b</p>
				<p class="entry-data" id="entry-elapsed" title="Time elapsed">0:00</p>
			</div>
			<textarea id="entry-body" onkeyup="edit.refreshSummary()"></textarea>
			<div id="map-holder">
				<div id="map-selector"></div>
			</div>
			<div id="photo-preview">
				<span></span><img />
			</div>
			<div id="video-preview"></div>
		</div>
		<div id="attach-area">
			<div class="icontags">
				<div class="weather"></div>
				<div class="emotion"></div>
				<div class="other"></div>
			</div>
			<hr />
			<div class="texttags">
				<span>&#xf02b</span>
				<input type="text" id="entry-tag" placeholder="Tags" autocomplete="off" onclick="this.select()" />
				<div class="other">
					<%
					if( textTags ) {
					for( i in textTags ) {
					%>
					<p title="Click to remove"><% print( "#" + textTags[i] ); %></p>
					<%
					}
					}
					%>
				</div>
			</div>
			<hr />
			<div class="types">
				<p id="no-cover" onclick="edit.coverSet(-1, true)" class="selected">&#xf016</p>
				<p id="photo-cover" onclick="edit.coverSet(0, true)">&#xf1c5</p>
				<p id="video-cover" onclick="edit.coverSet(1, true)">&#xf1c8</p>
				<p id="voice-cover" onclick="edit.coverSet(3, true)">&#xf1c7</p>
				<p id="place-cover" onclick="edit.coverSet(2, true)">&#xf041</p>
				<p id="music-cover" onclick="edit.coverSet(4, true)">&#xf001</p>
				<p id="movie-cover" onclick="edit.coverSet(5, true)">&#xf008</p>
				<p id="book-cover" onclick="edit.coverSet(6, true)">&#xf02d</p>
				<p id="weblink-cover" onclick="edit.coverSet(7, true)">&#xf0c1</p>
			</div>
			<hr />
			<div class="images"></div>
			<%
			if( video ) {
			for( i in video ) {
			%>
			<div class="video resource">
				<a class="<%- video[i].fileName %>" onclick="edit.video(<%- i %>)" title="View">
					<div class="thumb"><span></span></div>
					<input disabled class="title" value="<%- video[i].title %>" />
				</a>
			</div>
			<%
			}
			}

			if( voice ) {
			for( i in voice ) {
			%>
			<div class="voice resource">
				<a class="<%- voice[i].fileName %>" onclick="edit.voice(<%- i %>)" title="View">
					<div class="thumb"><span></span></div>
					<input disabled class="title" value="<%- voice[i].title %>" />
				</a>
			</div>
			<%
			}
			}

			if( place ) {
			for( i in place ) {
			%>
			<div class="place">
				<a title="Edit" onclick="edit.location(<%- i %>)" href="#">
					<div class="thumb"></div>
					<input disabled title="Place" class="title place-search" autocomplete="off" onclick="this.select()" value="<%- place[i].title %>" />
					<%
					if (place[i].latitude) {
					%>
					<input disabled title="Latitude" class="desc latitude" autocomplete="off" onclick="this.select()" value="<%- place[i].latitude %>" />
					<p>,</p>
					<input disabled title="Longitude" class="desc longitude" autocomplete="off" onclick="this.select()" value="<%- place[i].longitude %>" />
					<%
					} else {
					%>
					<input disabled title="Latitude" class="desc latitude" autocomplete="off" onclick="this.select()" id="latitude" />
					<p>,</p>
					<input disabled title="Longitude" class="desc longitude" autocomplete="off" onclick="this.select()" id="longitude" />
					<%
					}
					%>
				</a>
			</div>
			<%
			}
			}

			if( book ) {
			for( i in book ) {
			%>
			<div class="book">
				<a title="Edit" onclick="edit.book(<%- i %>)" href="#">
					<img class="thumb"><span></span>
					<input disabled class="title" placeholder="Book title" value="<%- book[i].title %>" autocomplete="off" onclick="this.select()" />
					<input disabled class="desc" placeholder="Author" value="<%- book[i].author %>" autocomplete="off" onclick="this.select()" />
				</a>
			</div>
			<%
			}
			}

			if( music ) {
			for( i in music ) {
			%>
			<div class="music">
				<a title="Edit" onclick="edit.music(<%- i %>)" href="#">
					<img class="thumb"><span></span>
					<input disabled class="title" placeholder="Track name" value="<%- music[i].title %>" autocomplete="off" onclick="this.select()" />
					<input disabled class="desc" placeholder="Artist" value="<%- music[i].author %>" autocomplete="off" onclick="this.select()" />
				</a>
			</div>
			<%
			}
			}

			if( movie ) {
			for( i in movie ) {
			%>
			<div class="movie">
				<a title="Edit" onclick="edit.movie(<%- i %>)" href="#">
					<img class="thumb"><span></span>
					<input disabled class="title" placeholder="Movie title" value="<%- movie[i].title %>" autocomplete="off" onclick="this.select()" />
					<input disabled class="desc" placeholder="Director" value="<%- movie[i].author %>" autocomplete="off" onclick="this.select()" />
				</a>
			</div>
			<%
			}
			}

			if( weblink ) {
			for( i in weblink ) {
			%>
			<div class="weblink">
				<a title="Edit" onclick="edit.weblink(<%- i %>)" href="#">
					<div class="thumb"><span></span></div>
					<input disabled class="title" placeholder="Title" value="<%- weblink[i].title %>" />
					<input disabled class="desc" placeholder="http://" value="<%- weblink[i].url %>" />
				</a>
			</div>
			<%
			}
			}
			%>
		</div>
	</script>
	<script type="text/x-template" id="archive-view">
		<li class="archive">
			<a href="#" class="<% if (protect) { print('protect'); } %>">
				<p class="title"><%= name.replace("_data","data") %></p>
				<p class="datetime"><%= created %></p>
				<p class="size" title="Size"><%= size %></p>
			</a>
		</li>
	</script>
	<script type="text/x-template" id="archive-detail-view">
		<div class="head">
			<p class="title"><%- name %></p>
			<p class="datetime">Created: <%- created %></p>
			<p class="datetime">Last Modified: <%- modified %></p>
		</div>
		<div class="content">
			<div class="lower">
				<div class="text">
					<table id="archive-preview">
						<tbody>
							<tr>
								<th>Created</th>
								<th>Title</th>
								<th>Contents</th>
							</tr>
							<%
							if (contents) {
							for (var i = 0; i !== contents.length && i < 50; ++i) {
							%>
							<tr>
								<td class="time"><%- contents[i]["time"]["created"] %></td>
								<td class="title"><%- contents[i]["title"] %></td>
								<td class="body" title="<%- contents[i]['text']['body'] %>"><%- contents[i]["text"]["body"] %></td>
							</tr>
							<%
							}
							}
							%>
						</tbody>
					</table>
				</div>
			</div>
		</div>
	</script>
</body>
</html>